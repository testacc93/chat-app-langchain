<!-- <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Chat app</title>
    </head>
    <body>
        <textarea name="" id="chat-log" cols="100" rows="10"></textarea>
        <input type="text" id="chat-message-input" size="100"><br>
        <input type="button" value="Send" id="chat-message-submit">
    </body>
    <script>
        var ws = new WebSocket('ws://127.0.0.1:8000/ws/sc/')
        ws.onmessage = function(event){
        const data = JSON.parse(event.data)
        document.querySelector('#chat-log').value += "Counselor:" + data.msg + '\n'
        }
        document.getElementById('chat-message-submit').onclick = 
        function(event){

        const messageInputDom = document.getElementById('chat-message-input')
        const message = messageInputDom.value
        document.querySelector('#chat-log').value += "User:" + message + '\n'

        ws.send(JSON.stringify({
        'msg':message
        }))
        messageInputDom.value = ''
        }
    </script>
    </html> -->
	{% load static %}
	<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
			integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
			integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
			crossorigin="anonymous"></script>
		<title>Document</title>
		<style>
			.mask-custom {
				background: rgba(24, 24, 16, .2);
				border-radius: 2em;
				backdrop-filter: blur(15px);
				border: 2px solid rgba(255, 255, 255, 0.05);
				background-clip: padding-box;
				box-shadow: 10px 10px 10px rgba(46, 54, 68, 0.03);
			}
			body {
				background: linear-gradient(to bottom right, rgba(252, 203, 144, 1), rgba(213, 126, 235, 1));
			}
		</style>
	</head>
	<body>
		<section class="gradient-custom">
			<div class="container py-5">
	
				<div class="row">
	
					<div class="col-md-6 col-lg-5 col-xl-5 mb-4 mb-md-0">
	
						<h5 class="font-weight-bold mb-3 text-center text-white">User</h5>
	
						<div class="card mask-custom">
							<div class="card-body">
	
								<ul class="list-unstyled mb-0">
									<li class="p-2">
										<a href="#!" class="d-flex justify-content-between link-light">
											<div class="d-flex flex-row">
												<!-- <img src={% static "coun.jpeg" %} alt="avatar"
													class="rounded-circle d-flex align-self-center me-3 shadow-1-strong"
													width="60"> -->
												<div class="pt-1">
													<p class="fw-bold mb-0">Counselor</p>
													<p class="small text-white">Talk to your counselor</p>
												</div>
											</div>
											<div class="pt-1">
												<p class="small text-white mb-1">5 mins ago</p>
												<span class="text-white float-end"><i class="fas fa-check"
														aria-hidden="true"></i></span>
											</div>
										</a>
									</li>
								</ul>
	
							</div>
						</div>
	
					</div>
	
					<div class="col-md-6 col-lg-7 col-xl-7">
	
						<ul id="parent-ul" class="list-unstyled text-white overflow-scroll" style="max-height: 60vh; scrollbar-width: none;">
						</ul>
							<div class="form-outline form-white position-absolute bottom-0 left-auto" style="right: 5%;">
								<textarea class="form-control" id="chat-message-input" rows="4" cols="50" ></textarea>
								<label class="form-label" for="textAreaExample3">Message</label>
								<button type="button" class="btn btn-light btn-lg btn-rounded float-end"
								id="chat-message-submit">Send</button>
							</div>
	
					</div>
	
				</div>
	
			</div>
		</section>
		<script>
			var ws = new WebSocket('ws://ec2-3-112-243-149.ap-northeast-1.compute.amazonaws.com/ws/sc/')
			ws.onmessage = function (event) {
				console.log("adddding")

				const data = JSON.parse(event.data)
				// document.querySelector('#chat-message-input').value += "Counselor:" + data.msg + '\n'
				var li_ele = document.createElement('li')
				console.log("hhhding")

				li_ele.classList.add('d-flex')
				li_ele.classList.add('justify-content-between')
				li_ele.classList.add('mb-4')


				// var parent_ul = document.getElementById('parent-ul')
				// parent_ul.appendChild(li_ele_chat_box)
				// console.log("ekldkaldksdlk")

				var div_mask = document.createElement('div')
				div_mask.classList.add('card')
				div_mask.classList.add('mask-custom')
				div_mask.classList.add('w-100')

				var div_header = document.createElement('div')
				div_header.classList.add('card-header')
				div_header.classList.add('d-flex')
				div_header.classList.add('justify-content-between')
				div_header.classList.add('p-3')
				div_header.style.borderBottom = '1px solid rgba(255,255,255,.3);'

				var p_ele = document.createElement('p')
				p_ele.classList.add('fw-bold')
				p_ele.classList.add('mb-0')
				p_ele.innerText = 'Counselor'


				// var p_ele_2 = document.createElement('p')
				// p_ele.classList.add('text-light')
				// p_ele.classList.add('mb-0')
				// p_ele.classList.add('small')
				
				// p_ele.innerText = 'Counselor'

				// var i_ele = document.createElement('i')
				// 	i_ele.classList.add('far')
				// 	i_ele.classList.add('fa-clock')
	
					var div_card_body = document.createElement("div")
					div_card_body.classList.add('card-body')
	
					var p_ele_mb0 = document.createElement('p')
					p_ele_mb0.classList.add('mb-0')
					p_ele_mb0.innerText = data.msg
					div_card_body.appendChild(p_ele_mb0)
					
					
					div_header.appendChild(p_ele)
					// p_ele_2.appendChild(i_ele)
	
					// div_header.appendChild(p_ele_2)
					div_mask.appendChild(div_header)
					div_mask.appendChild(div_card_body)
					li_ele.appendChild(div_mask)
					//div_mask.appendChild(div_header)
					var parent_li = document.getElementById('parent-ul')
					parent_li.appendChild(li_ele)
				
			}
	
			document.getElementById('chat-message-submit').onclick =
				function (event) {
					const messageInputDom = document.getElementById('chat-message-input')
					const message = messageInputDom.value
					document.querySelector('#chat-message-input').value += "User:" + message + '\n'
	
					ws.send(JSON.stringify({
					'msg':message
					}))
					messageInputDom.value = ''
					var li_ele = document.createElement('li')
					li_ele.classList.add("d-flex")
					li_ele.classList.add("justify-content-between")
					li_ele.classList.add("mb-4")
					li_ele.classList.add("mb-4000000")
	
					var img_ele = document.createElement('img')
					img_ele.classList.add("rounded-circle")
					img_ele.classList.add("d-flex")
					img_ele.classList.add("align-self-center")
					img_ele.classList.add("me-3")
					img_ele.classList.add("shadow-1-strong")
					li_ele.appendChild(img_ele)
	
					var div_mask = document.createElement('div')
					div_mask.classList.add('card')
					div_mask.classList.add('mask-custom')
					var div_header = document.createElement('div')
					div_header.classList.add('card-header')
					div_header.classList.add('d-flex')
					div_header.classList.add('justify-content-between')
					div_header.classList.add('p-3')
					div_header.style.borderBottom = '1px solid rgba(255,255,255,.3)'
					var p_ele = document.createElement('p')
					p_ele.classList.add('fw-bold')
					p_ele.classList.add('mb-0')
					p_ele.innerText = 'Student'
	
					var p_ele_2 = document.createElement('p')
					p_ele.classList.add('text-light')
					p_ele.classList.add('small')
					p_ele.classList.add('mb-0')
	
					var i_ele = document.createElement('i')
					i_ele.classList.add('far')
					i_ele.classList.add('fa-clock')
	
					var div_card_body = document.createElement("div")
					div_card_body.classList.add('card-body')
	
					var p_ele_mb0 = document.createElement('p')
					p_ele_mb0.classList.add('mb-0')
					p_ele_mb0.innerText = message
					div_card_body.appendChild(p_ele_mb0)
					
					div_header.appendChild(p_ele)
					p_ele_2.appendChild(i_ele)
	
					div_header.appendChild(p_ele_2)
					div_mask.appendChild(div_header)
					div_mask.appendChild(div_card_body)
					li_ele.appendChild(img_ele)
					li_ele.appendChild(div_mask)
					//div_mask.appendChild(div_header)
					var parent_li = document.getElementById('parent-ul')
					parent_li.appendChild(li_ele)
				}
		</script>
	</body>
</html>